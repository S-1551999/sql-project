CREATE TABLE hotel ( hotel_no CHAR(4) NOT NULL, 
name VARCHAR(20) NOT NULL, 
address VARCHAR(50) NOT NULL,
primary key(hotel_no)
);

INSERT INTO hotel VALUES ('H111', 'Grosvenor_lO', 'London');
INSERT INTO hotel VALUES ('H112', 'Grosvenor_MU', 'Mumbai');
INSERT INTO hotel VALUES ('H113', 'Grosvenor_BE', 'BERLIN');
INSERT INTO hotel VALUES ('H114', 'Grosvenor_NY', 'NEWYORK');
INSERT INTO hotel VALUES ('H115', 'Grosvenor_DC', 'DC');

SELECT * FROM HOTEL;

SELECT COUNT(*) FROM HOTEL;

drop table room;
CREATE TABLE room ( 
room_no VARCHAR(4) NOT NULL,
hotel_no CHAR(4) NOT NULL, 
type CHAR(1) NOT NULL, 
PRIMARY KEY( room_no , hotel_no),
price DECIMAL(5,2) NOT NULL);

INSERT INTO room VALUES ('R101', 'H111', 'S', 72.00);
INSERT INTO room VALUES ('R102', 'H111', 'S', 72.00);
INSERT INTO room VALUES ('R103', 'H111', 'D', 200.00);
INSERT INTO room VALUES ('R104', 'H111', 'D', 200.00);
INSERT INTO room VALUES ('R105', 'H111', 'T',400.00);
INSERT INTO room VALUES ('R106', 'H111', 'T', 400.00);
INSERT INTO room VALUES ('R107', 'H111', 'Q', 500.00);
INSERT INTO room VALUES ('R108', 'H111', 'Q', 500.00);

INSERT INTO room VALUES ('R211', 'H112', 'S', 50.00);
INSERT INTO room VALUES ('R212', 'H112', 'S', 50.00);
INSERT INTO room VALUES ('R213', 'H112', 'D',80.00);
INSERT INTO room VALUES ('R214', 'H112', 'D', 80.00);
INSERT INTO room VALUES ('R215', 'H112', 'D', 80.00);
INSERT INTO room VALUES ('R216', 'H112', 'T', 150.00);
INSERT INTO room VALUES ('R217', 'H112', 'Q', 200.00);
INSERT INTO room VALUES ('R331', 'H113', 'S', 100.00);
INSERT INTO room VALUES ('R332', 'H113', 'S', 100.00);
INSERT INTO room VALUES ('R333', 'H113', 'D', 300.00);
INSERT INTO room VALUES ('R334', 'H113', 'D',300.00);
INSERT INTO room VALUES ('R335', 'H113', 'T', 400.00);
INSERT INTO room VALUES ('R336', 'H113', 'T', 400.00);
INSERT INTO room VALUES ('R337', 'H113', 'Q', 500.00);
INSERT INTO room VALUES ('R441', 'H114', 'S', 150.00);
INSERT INTO room VALUES ('R442', 'H114', 'S', 150.00);
INSERT INTO room VALUES ('R443', 'H114', 'S', 150.00);
INSERT INTO room VALUES ('R444', 'H114', 'D', 250.00);
INSERT INTO room VALUES ('R445', 'H114', 'D', 250.00);
INSERT INTO room VALUES ('R446', 'H114', 'D', 250.00);
INSERT INTO room VALUES ('R447', 'H114', 'T', 350.00);
INSERT INTO room VALUES ('R448', 'H114', 'Q', 450.00);
INSERT INTO room VALUES ('R449', 'H114', 'Q', 450.00);
INSERT INTO room VALUES ('R551', 'H115', 'S', 200.00);
INSERT INTO room VALUES ('R552', 'H115', 'S', 200.00);
INSERT INTO room VALUES ('R553', 'H115', 'D', 300.00);
INSERT INTO room VALUES ('R554', 'H115', 'T', 400.00);
INSERT INTO room VALUES ('R555', 'H115', 'T', 400.00);
INSERT INTO room VALUES ('R556', 'H115', 'Q', 500.00);

UPDATE ROOM SET PRICE=30 WHERE ROOM_NO IN('R211','R212');
UPDATE ROOM SET PRICE=30 WHERE ROOM_NO IN('R211','R212');


DROP TABLE  guest;
CREATE TABLE guest ( 
guest_no  VARCHAR(10) NOT NULL, 
name VARCHAR(50) NOT NULL,
 address VARCHAR(50) NOT NULL,
 PRIMARY KEY (GUEST_NO)
 );
 
 INSERT INTO guest VALUES ('G111', 'SHUBHAM C', 'London');
 INSERT INTO guest VALUES ('G112', 'AJAY GUPTA', 'London');
 INSERT INTO guest VALUES ('G113', 'RAHUL GUPTA', 'London');
 INSERT INTO guest VALUES ('G114', 'VIJAY BANSAL', 'MUMBAI');
INSERT INTO guest VALUES ('G1115', 'VIN PATHAK', 'MUMBAI');

 INSERT INTO guest VALUES ('G211', 'ABHAY SHA', 'MUMBAI');
 INSERT INTO guest VALUES ('G212', 'RAJ SINGH', 'BERLIN');
 INSERT INTO guest VALUES ('G213', 'SUM KUM', 'BERLIN');
 INSERT INTO guest VALUES ('G214', 'RONY JAIS', 'BERLIN');
 INSERT INTO guest VALUES ('G215', 'VIBHOR GOG', 'PARIS');
 
 INSERT INTO guest VALUES ('G311', 'AMIT LAL', 'PARIS');
 INSERT INTO guest VALUES ('G312', 'RAJESH DALVI', 'PARIS');
INSERT INTO guest VALUES ('G313', 'SEEMA CHAUBE', 'PARIS');
 INSERT INTO guest VALUES ('G314', 'SANJEEV RATHOD', 'DC');
 
 INSERT INTO guest VALUES ('G411', 'ANUJ SINGH', 'DC');
 INSERT INTO guest VALUES ('G412', 'ATUL KAMBLE', 'DC');
 INSERT INTO guest VALUES ('G413', 'VIN DAMO', 'HK');
 INSERT INTO guest VALUES ('G414', 'SURAJ KUMAR', 'HK');
 
 INSERT INTO guest VALUES ('G511', 'RAJ SIGH', 'HK');
 INSERT INTO guest VALUES ('G512', 'KAPIL BEDI', 'CAPETOWN');
INSERT INTO guest VALUES ('G513', 'DEVESH AGH', 'CAPETOWN');
 INSERT INTO guest VALUES ('G514', 'BHUVESH WAGH', 'CAPETOWN');


SELECT * FROM GUEST;


CREATE TABLE booking (
hotel_no CHAR(4) NOT NULL,
 guest_no CHAR(4) NOT NULL,
 date_from DATETIME NOT NULL,
 date_to DATETIME NULL,  
 room_no CHAR(4) NOT NULL,
 FOREIGN  KEY(GUEST_NO) REFERENCES GUEST(GUEST_NO),
 FOREIGN KEY(HOTEL_NO) REFERENCES HOTEL(HOTEL_NO),
  FOREIGN KEY(ROOM_NO) REFERENCES ROOM(ROOM_NO)
 );

INSERT INTO booking VALUES ('H111', 'G111', DATE'1999-01-01', DATE'1999-01-10', 'R101');
INSERT INTO booking VALUES ('H111', 'G112', DATE'1999-01-12', DATE'1999-01-22', 'R102');
INSERT INTO booking VALUES ('H111', 'G113', DATE'1999-02-02', DATE'1999-02-15', 'R103');
INSERT INTO booking VALUES ('H111', 'G113', DATE'1999-03-03', DATE'1999-03-07', 'R104');
INSERT INTO booking VALUES ('H111', 'G115', DATE'2000-02-01', DATE'2000-02-12', 'R105');
INSERT INTO booking VALUES ('H111', 'G111', DATE'1999-05-01', DATE'1999-05-10', 'R106');
INSERT INTO booking VALUES ('H111', 'G115', DATE'2001-01-01', DATE'2001-01-12', 'R107');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2001-03-03', DATE'2001-03-07', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2001-08-03', DATE'2001-08-07', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2001-08-09', DATE'2001-08-020', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2002-08-09', DATE'2002-08-020', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2003-08-09', DATE'2003-08-020', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2004-08-09', DATE'2004-08-020', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2005-08-09', DATE'2005-08-020', 'R108');
INSERT INTO booking VALUES ('H111', 'G114', DATE'2006-08-09', DATE'2006-08-020', 'R108');

INSERT INTO booking VALUES ('H112', 'G211', DATE'1999-01-01', DATE'1999-01-02', 'R211');
INSERT INTO booking VALUES ('H112', 'G212', DATE'1999-02-05', DATE'1999-02-07', 'R212');
INSERT INTO booking VALUES ('H112', 'G213', DATE'1999-03-06', DATE'1999-03-12', 'R213');
INSERT INTO booking VALUES ('H112', 'G211', DATE'2000-01-09', DATE'2000-01-15', 'R214');
INSERT INTO booking VALUES ('H112', 'G215', DATE'2000-01-23', DATE'2000-01-30', 'R215');
INSERT INTO booking VALUES ('H112', 'G212', DATE'1999-04-18', DATE'1999-04-24', 'R216');
INSERT INTO booking VALUES ('H112', 'G214', DATE'2001-01-12', DATE'2001-01-22', 'R217');
INSERT INTO booking VALUES ('H112', 'G213', DATE'2001-01-28', DATE'2001-01-31', 'R211');
INSERT INTO booking VALUES ('H112', 'G212', DATE'2001-08-28', DATE'2001-08-31', 'R211');
INSERT INTO booking VALUES ('H112', 'G212', DATE'2002-08-18', DATE'2002-08-24', 'R216');
INSERT INTO booking VALUES ('H112', 'G214', DATE'2003-08-12', DATE'2003-08-22', 'R217');
INSERT INTO booking VALUES ('H112', 'G213', DATE'2004-08-28', DATE'2004-08-31', 'R211');
INSERT INTO booking VALUES ('H112', 'G212', DATE'2005-08-28', DATE'2005-08-31', 'R211');



INSERT INTO booking VALUES ('H113', 'G311', DATE'1999-01-01', DATE'1999-01-02', 'R331');
INSERT INTO booking VALUES ('H113', 'G311', DATE'1999-02-01', DATE'1999-02-03', 'R332');
INSERT INTO booking VALUES ('H113', 'G312', DATE'1999-01-01', DATE'1999-01-04', 'R334');
INSERT INTO booking VALUES ('H113', 'G312', DATE'2000-01-01', DATE'2000-01-05', 'R335');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2000-01-01', DATE'2000-01-06', 'R336');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2000-02-01', DATE'2000-02-07', 'R337');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2001-01-01', DATE'2001-01-08', 'R334');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2001-02-01', DATE'2001-02-09', 'R335');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2002-08-01', DATE'2002-08-06', 'R336');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2003-08-01', DATE'2003-08-07', 'R337');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2004-08-01', DATE'2004-08-08', 'R334');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2005-08-01', DATE'2005-08-09', 'R335');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2006-08-01', DATE'2006-08-06', 'R336');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2007-08-01', DATE'2007-08-07', 'R337');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2008-08-01', DATE'2008-08-08', 'R334');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2009-08-01', DATE'2009-08-09', 'R335');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2022-10-14', DATE'2022-10-15', 'R336');
INSERT INTO booking VALUES ('H113', 'G312', DATE'2022-10-14', DATE'2022-10-15', 'R337');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2022-10-14', DATE'2022-10-15', 'R334');
INSERT INTO booking VALUES ('H113', 'G311', DATE'2022-10-14', DATE'2022-10-15', 'R335');
INSERT INTO booking VALUES ('H113', 'G313', DATE'2022-10-15', DATE'2022-10-16', 'R336');
INSERT INTO booking VALUES ('H113', 'G312', DATE'2022-10-15', DATE'2022-10-16', 'R337');
INSERT INTO booking VALUES ('H113', 'G314', DATE'2022-10-15', DATE'2022-10-16', 'R334');
INSERT INTO booking VALUES ('H113', 'G311', DATE'2022-10-15', DATE'2022-10-16', 'R335');





INSERT INTO booking VALUES ('H114', 'G411', DATE'1999-08-01', DATE'1999-08-08', 'R442');
INSERT INTO booking VALUES ('H114', 'G412', DATE'2000-01-01', DATE'2000-01-05', 'R443');
INSERT INTO booking VALUES ('H114', 'G413', DATE'2001-01-01', DATE'2001-01-03', 'R444');
INSERT INTO booking VALUES ('H114', 'G414', DATE'1999-01-01', DATE'1999-01-07', 'R446');
INSERT INTO booking VALUES ('H114', 'G414', DATE'2000-08-01', DATE'2000-08-07', 'R446');
INSERT INTO booking VALUES ('H114', 'G414', DATE'2022-10-01', DATE'2022-10-15', 'R446');
INSERT INTO booking VALUES ('H114', 'G413', DATE'2022-10-01', DATE'2022-10-15', 'R442');
INSERT INTO booking VALUES ('H114', 'G412', DATE'2022-10-01', DATE'2022-10-15', 'R443');
INSERT INTO booking VALUES ('H114', 'G414', DATE'2002-08-01', DATE'2002-08-07', 'R446');
INSERT INTO booking VALUES ('H114', 'G414', DATE'2003-08-01', DATE'2003-08-15', 'R446');
INSERT INTO booking VALUES ('H114', 'G413', DATE'2004-08-01', DATE'2004-08-15', 'R442');
INSERT INTO booking VALUES ('H114', 'G412', DATE'2005-08-01', DATE'2005-08-15', 'R443');
INSERT INTO booking VALUES ('H114', 'G414', DATE'2022-10-14', DATE'2003-10-15', 'R446');
INSERT INTO booking VALUES ('H114', 'G413', DATE'2022-10-14', DATE'2004-10-15', 'R442');
INSERT INTO booking VALUES ('H114', 'G412', DATE'2022-10-14', DATE'2005-10-15', 'R443');
INSERT INTO booking VALUES ('H114', 'G414', DATE'2022-10-15', DATE'2003-10-16', 'R446');
INSERT INTO booking VALUES ('H114', 'G413', DATE'2022-10-15', DATE'2004-10-16', 'R442');
INSERT INTO booking VALUES ('H114', 'G412', DATE'2022-10-15', DATE'2005-10-16', 'R443');



INSERT INTO booking VALUES ('H115', 'G511', DATE'1999-01-01', DATE'1999-01-02', 'R551');
INSERT INTO booking VALUES ('H115', 'G512', DATE'2000-01-01', DATE'2000-01-05', 'R552');
INSERT INTO booking VALUES ('H115', 'G513', DATE'2000-01-01', DATE'2000-01-06', 'R553');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2001-01-01', DATE'2001-01-07', 'R555');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2001-01-01', DATE (NULL), 'R555');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2002-01-01', DATE (NULL), 'R555');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2022-10-01', DATE'2022-10-15', 'R555');
INSERT INTO booking VALUES ('H115', 'G513', DATE'2022-10-01', DATE'2022-10-15', 'R552');
INSERT INTO booking VALUES ('H115', 'G512', DATE'2022-10-01', DATE'2022-10-15', 'R553');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2003-08-01', DATE'2003-08-15', 'R555');
INSERT INTO booking VALUES ('H115', 'G513', DATE'2004-08-01', DATE'2004-08-15', 'R552');
INSERT INTO booking VALUES ('H115', 'G512', DATE'2005-08-01', DATE'2005-08-15', 'R553');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2006-08-01', DATE'2006-08-15', 'R555');
INSERT INTO booking VALUES ('H115', 'G513', DATE'2007-08-01', DATE'2007-08-15', 'R552');
INSERT INTO booking VALUES ('H115', 'G512', DATE'2008-08-01', DATE'2008-08-15', 'R553');
INSERT INTO booking VALUES ('H115', 'G514', DATE'2022-10-05', DATE'2022-10-15', 'R554');
INSERT INTO booking VALUES ('H115', 'G513', DATE'2022-10-05', DATE'2022-10-15', 'R551');
INSERT INTO booking VALUES ('H115', 'G512', DATE'2022-10-05', DATE'2022-10-15', 'R553');
INSERT INTO booking VALUES ('H111', 'G514', DATE'2022-10-14', DATE'2022-10-15', 'R554');
INSERT INTO booking VALUES ('H113', 'G513', DATE'2022-10-14', DATE'2022-10-15', 'R551');
INSERT INTO booking VALUES ('H111', 'G512', DATE'2022-10-15', DATE'2022-10-18', 'R553');
INSERT INTO booking VALUES ('H113', 'G512', DATE'2022-10-15', DATE'2022-10-18', 'R553');


SELECT *  FROM BOOKING;

UPDATE room SET price = price*1.05;
set sql_safe_updates=0;


CREATE TABLE booking_old ( 
hotel_no CHAR(4) NOT NULL, 
guest_no CHAR(4) NOT NULL, 
date_from DATETIME NOT NULL, 
date_to DATETIME NULL, 
room_no VARCHAR(4) NOT NULL
);

INSERT INTO booking_old (SELECT * FROM booking WHERE date_to < DATE'2000-01-01');

DELETE FROM booking WHERE date_to < DATE('2000-01-01');

SELECT * FROM HOTEL;
SELECT * FROM ROOM;
SELECT * FROM GUEST;
SELECT * FROM BOOKING;
SELECT * FROM BOOKING_OLD;